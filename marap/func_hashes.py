def resolve_func_by_hash(func_name, xor_key1, xor_key2):
    func_hash = 0
    i = 0
    v3 = 0

    while i < len(func_name):
        ch = ord(func_name[i])

        func_hash ^= ch
        
        v4 = (i + ch) & 0x3f
        if v4 and v4 != 0x20:
            if v4 > 0x20:
                v11 = v4 - 32
                v12 = 64 - v4
                v7 = (func_hash >> (64 - v4)) ^ (v3 << v11)
                v8 = func_hash << v11
                v9 = v3 >> v12
            else:
                v6 = 32 - v4
                v7 = (func_hash << v4) ^ (v3 >> v6)
                v8 = func_hash >> v6
                v9 = v3 << v4

            func_hash = (func_hash ^ v7) & 0xffffffff
            v3 = (v3 ^ v9 ^ v8) & 0xffffffff
        
        i += 1

    hash1 = (func_hash ^ xor_key1) & 0xffffffff
    hash2 = (v3 ^ xor_key2) & 0xffffffff

    return (hash1, hash2)


if __name__ == "__main__":
    func_name = "WinHttpSendRequest"
    hash1, hash2 = resolve_func_by_hash(func_name, 0x2606765A, 0x16CA7588)
    print hex(hash1)
    print hex(hash2)
