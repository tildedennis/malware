start = ScreenEA()

xor_key = []
for i in range(4):
    xor_key.append(chr(Byte(start+i)))
    
xor_key = "".join(xor_key)

start += 4
encbuf = []
i = 0
while True:
    encbyte = Byte(start+i)
    if encbyte == 0:
        break
    
    encbuf.append(chr(encbyte))
    i += 1
    
encbuf = "".join(encbuf)

round1 = []
for i, encbyte in enumerate(encbuf):
    plainbyte = ord(encbyte) ^ ord(xor_key[i % len(xor_key)])
    round1.append(chr(plainbyte))

round1 = "".join(round1)
    
round2 = []
round2_len = struct.unpack("H", round1[:2])[0]
round1 = round1[2:]
for i in range(round2_len):
    plainbyte = ord(round1[i]) ^ 8 * (i + 12)
    round2.append(chr(plainbyte & 0xff))
    
print "".join(round2)
